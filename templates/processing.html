{% extends "base.html" %}

{% block title %}Creating Your Travel Plan - GlobePiloT{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <!-- Processing Status -->
        <div class="card">
            <div class="card-header text-center">
                <h2><i class="fas fa-magic me-3"></i>Creating Your Travel Plan
                    {% if request_details.get('revision') %}
                    <span class="badge bg-warning ms-2">
                        <i class="fas fa-sync-alt me-1"></i>Revision
                    </span>
                    {% endif %}
                </h2>
                <p class="mb-0 opacity-90">
                    {% if request_details.get('revision') %}
                    Our AI agents are revising your travel plan with updated requirements
                    {% else %}
                    Our AI agents are working hard to create your perfect itinerary
                    {% endif %}
                </p>
            </div>
            <div class="card-body p-4">
                <!-- Enhanced Progress Bar -->
                <div class="progress-container mb-4">
                    <div class="progress mb-3" style="height: 30px;">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" 
                             role="progressbar" style="width: 0%" 
                             id="progressBar"
                             aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                            <span id="progress-text" class="fw-bold">Starting...</span>
                        </div>
                    </div>
                    
                    <!-- Current Agent Status -->
                    <div class="text-center mb-3">
                        <h5 id="statusText" class="text-primary">Initializing AI agents...</h5>
                        <p id="statusDetail" class="text-muted">Getting ready to start your travel planning</p>
                    </div>
                    
                    <!-- Time Remaining Display -->
                    <div class="text-center mb-3">
                        <small class="text-muted">
                            <i class="fas fa-clock me-1"></i>
                            Estimated time remaining: <span id="time-remaining">2-3 minutes</span>
                        </small>
                    </div>
                </div>
                
                <!-- AI Agents Status -->
                <div class="row justify-content-center">
                    <div class="col-md-5 mb-4">
                        <h6 class="text-primary mb-3 text-center"><i class="fas fa-robot me-2"></i>Planning Agents</h6>
                        <div class="agent-status-list" id="agents-planning">
                            <div class="agent-item" id="agent-general" data-agent="GeneralResearchAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-search agent-icon me-2"></i>
                                    <span class="agent-name">General Research</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Researching destination basics & safety</div>
                            </div>
                            
                            <div class="agent-item" id="agent-weather" data-agent="WeatherAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-cloud-sun agent-icon me-2"></i>
                                    <span class="agent-name">Weather Analysis</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Checking weather & packing tips</div>
                            </div>
                            
                            <div class="agent-item" id="agent-flight" data-agent="FlightAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-plane agent-icon me-2"></i>
                                    <span class="agent-name">Flight Research</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Optimizing flight options</div>
                            </div>
                            
                            <div class="agent-item" id="agent-accommodations" data-agent="AccommodationsAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-bed agent-icon me-2"></i>
                                    <span class="agent-name">Accommodations</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Finding best places to stay</div>
                            </div>
                            
                            <div class="agent-item" id="agent-budget" data-agent="BudgetAnalysisAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-calculator agent-icon me-2"></i>
                                    <span class="agent-name">Budget Analysis</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Calculating costs & optimization</div>
                            </div>
                            
                            <div class="agent-item" id="agent-activities" data-agent="ActivitiesAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-map-signs agent-icon me-2"></i>
                                    <span class="agent-name">Activities</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Discovering attractions & tours</div>
                            </div>
                            
                            <div class="agent-item" id="agent-events" data-agent="LocalEventsAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-calendar-check agent-icon me-2"></i>
                                    <span class="agent-name">Local Events</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Finding restaurants & events</div>
                            </div>
                            
                            <div class="agent-item" id="agent-transport" data-agent="LocalTransportationAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-subway agent-icon me-2"></i>
                                    <span class="agent-name">Transportation</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Planning local transport</div>
                            </div>
                            
                            <div class="agent-item" id="agent-planner" data-agent="TravelPlannerAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-route agent-icon me-2"></i>
                                    <span class="agent-name">Travel Planner</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Creating detailed itinerary</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5 mb-4">
                        <h6 class="text-primary mb-3 text-center"><i class="fas fa-shield-alt me-2"></i>Validation Agents</h6>
                        <div class="agent-status-list" id="agents-validation">
                            <div class="agent-item" id="agent-validation" data-agent="ValidationAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-double agent-icon me-2"></i>
                                    <span class="agent-name">Validation Agent</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Validating plan requirements</div>
                            </div>
                            
                            <div class="agent-item" id="agent-quality" data-agent="QualityControlAgent">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-shield-alt agent-icon me-2"></i>
                                    <span class="agent-name">Quality Control Agent</span>
                                    <div class="agent-status-icons ms-auto">
                                        <i class="fas fa-spinner fa-spin status-icon active-icon d-none text-primary"></i>
                                        <i class="fas fa-check-circle text-success status-icon complete-icon d-none"></i>
                                    </div>
                                </div>
                                <div class="agent-description text-muted small">Ensuring plan quality</div>
                            </div>
                        </div>
                        
                        <div class="mt-4 text-center">
                            <h6 class="text-success mb-3"><i class="fas fa-check-circle me-2"></i>Validation Features</h6>
                            <ul class="list-unstyled text-sm" style="max-width: 300px; margin: 0 auto; text-align: left;">
                                <li><i class="fas fa-check text-success me-2"></i>Budget compliance checking</li>
                                <li><i class="fas fa-check text-success me-2"></i>Requirements validation</li>
                                <li><i class="fas fa-check text-success me-2"></i>Quality control & revisions</li>
                                <li><i class="fas fa-check text-success me-2"></i>Final plan approval</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Processing Log -->
                <div class="mt-4">
                    <h6 class="text-primary mb-3"><i class="fas fa-list me-2"></i>Processing Log</h6>
                    <div id="processingLog" class="alert alert-light" style="max-height: 200px; overflow-y: auto;">
                        <div class="text-muted">Waiting for processing to begin...</div>
                    </div>
                </div>
                
                <!-- Cancel Button -->
                <div class="text-center mt-4">
                    <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Start Over
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Request Summary -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-clipboard-list me-2"></i>Your Travel Request</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong><i class="fas fa-map-marker-alt me-2"></i>Route:</strong> 
                           {{ request_details.origin }} → {{ request_details.destination }}</p>
                        <p><strong><i class="fas fa-calendar me-2"></i>Dates:</strong> 
                           {{ request_details.departure_date }} to {{ request_details.return_date }}</p>
                        <p><strong><i class="fas fa-users me-2"></i>Travelers:</strong> 
                           {{ request_details.travelers }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong><i class="fas fa-dollar-sign me-2"></i>Budget:</strong> 
                           {{ request_details.budget_range }}</p>
                        <p><strong><i class="fas fa-suitcase me-2"></i>Trip Type:</strong> 
                           {{ request_details.trip_type|title }}</p>
                        <p><strong><i class="fas fa-clock me-2"></i>Requested:</strong> 
                           {{ request_details.timestamp }}</p>
                    </div>
                </div>
                {% if request_details.special_requirements %}
                <div class="mt-3">
                    <strong><i class="fas fa-list-ul me-2"></i>Special Requirements:</strong>
                    <div class="alert alert-info mt-2">{{ request_details.special_requirements }}</div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
let checkInterval;
let startTime = Date.now();
let currentStep = 0;

const steps = [
    'Initializing AI agents...',
    'General Research Agent working...',
    'Accommodations Agent working...',
    'Activities Agent working...',
    'Local Events Agent working...',
    'Budget Analysis Agent working...',
    'Flight Agent working...',
    'Local Transportation Agent working...',
    'Weather Agent working...',
    'Travel Planner Agent working...',
    'Validation Agent checking...',
    'Quality Control Agent reviewing...',
    'Finalizing your travel plan...'
];

const agentMapping = {
    'GeneralResearchAgent': 'general',
    'AccommodationsAgent': 'accommodations', 
    'ActivitiesAgent': 'activities',
    'LocalEventsAgent': 'events',
    'BudgetAnalysisAgent': 'budget', 
    'FlightAgent': 'flight',
    'LocalTransportationAgent': 'transport',
    'WeatherAgent': 'weather',
    'TravelPlannerAgent': 'planner',
    'ValidationAgent': 'validation',
    'QualityControlAgent': 'quality'
};

function updateProgress(percentage, statusText, detail) {
    document.getElementById('progressBar').style.width = percentage + '%';
    document.getElementById('statusText').textContent = statusText;
    document.getElementById('statusDetail').textContent = detail;
}

function activateAgent(agentName) {
    const agentKey = agentMapping[agentName];
    if (agentKey) {
        const icon = document.getElementById('icon-' + agentKey);
        if (icon) {
            icon.className = 'fas fa-circle text-warning me-2';
            icon.style.animation = 'pulse 1s infinite';
        }
    }
}

function completeAgent(agentName) {
    const agentKey = agentMapping[agentName];
    if (agentKey) {
        const icon = document.getElementById('icon-' + agentKey);
        if (icon) {
            icon.className = 'fas fa-check-circle text-success me-2';
            icon.style.animation = 'none';
        }
    }
}

function addLogEntry(message, type = 'info') {
    const log = document.getElementById('processingLog');
    const elapsed = Math.round((Date.now() - startTime) / 1000);
    const timestamp = new Date().toLocaleTimeString();
    
    const entry = document.createElement('div');
    entry.className = 'log-entry mb-1';
    entry.innerHTML = `
        <small class="text-muted">[${timestamp}]</small> 
        <span class="text-${type === 'error' ? 'danger' : 'primary'}">${message}</span>
    `;
    
    log.appendChild(entry);
    log.scrollTop = log.scrollHeight;
}

// Enhanced progress tracking functions
let lastActiveAgent = null;
let lastCompletedAgents = [];

function updateProgressDisplay(percentage, statusText, timeRemaining) {
    // Update progress bar
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progress-text');
    
    if (progressBar) {
        progressBar.style.width = percentage + '%';
        progressBar.setAttribute('aria-valuenow', percentage);
    }
    
    if (progressText) {
        progressText.textContent = Math.round(percentage) + '% Complete';
    }
    
    // Update status text
    const statusTextElement = document.getElementById('statusText');
    if (statusTextElement) {
        statusTextElement.textContent = statusText;
    }
    
    // Update time remaining
    const timeRemainingElement = document.getElementById('time-remaining');
    if (timeRemainingElement && timeRemaining !== undefined) {
        timeRemainingElement.textContent = formatTimeRemaining(timeRemaining);
    }
}

function updateAgentStatus(currentAgent, completedAgents, currentAgentInfo) {
    // Reset all agents to default state
    const agentItems = document.querySelectorAll('.agent-item');
    agentItems.forEach(item => {
        item.classList.remove('active', 'completed');
    });
    
    const statusIcons = document.querySelectorAll('.status-icon');
    statusIcons.forEach(icon => {
        icon.classList.add('d-none');
    });
    
    // Mark completed agents
    completedAgents.forEach(agent => {
        const agentElement = document.querySelector(`.agent-item[data-agent="${agent}"]`);
        if (agentElement) {
            agentElement.classList.add('completed');
            const completeIcon = agentElement.querySelector('.complete-icon');
            if (completeIcon) {
                completeIcon.classList.remove('d-none');
            }
        }
    });
    
    // Mark current active agent
    if (currentAgent) {
        const currentAgentElement = document.querySelector(`.agent-item[data-agent="${currentAgent}"]`);
        if (currentAgentElement) {
            currentAgentElement.classList.add('active');
            const activeIcon = currentAgentElement.querySelector('.active-icon');
            if (activeIcon) {
                activeIcon.classList.remove('d-none');
            }
        }
        
        // Update status detail with current agent description
        if (currentAgentInfo && currentAgentInfo.description) {
            const statusDetail = document.getElementById('statusDetail');
            if (statusDetail) {
                statusDetail.textContent = currentAgentInfo.description;
            }
        }
    }
}

function formatTimeRemaining(minutes) {
    if (minutes === 0) return "Almost done!";
    if (minutes < 1) return "Less than 1 minute";
    if (minutes < 2) return "About 1 minute";
    return `About ${Math.round(minutes)} minutes`;
}

function checkStatus() {
    fetch('/status')
        .then(response => response.json())
        .then(data => {
            if (data.is_processing) {
                // Use enhanced progress tracking from backend
                const progress = data.progress_percentage || 0;
                const timeRemaining = data.time_remaining_minutes || 0;
                const currentAgent = data.current_agent;
                const completedAgents = data.completed_agents || [];
                const currentAgentInfo = data.current_agent_info;
                
                // Update progress bar with actual percentage
                updateProgressDisplay(progress, data.progress || 'Processing...', timeRemaining);
                
                // Update agent status based on backend data
                updateAgentStatus(currentAgent, completedAgents, currentAgentInfo);
                
                // Add log entries for agent changes
                if (currentAgent && currentAgent !== lastActiveAgent) {
                    const agentName = currentAgentInfo ? currentAgentInfo.name : currentAgent;
                    const agentDesc = currentAgentInfo ? currentAgentInfo.description : 'Working on your travel plan';
                    addLogEntry(`${agentName} is now active: ${agentDesc}`);
                    lastActiveAgent = currentAgent;
                }
                
                // Log completed agents
                completedAgents.forEach(agent => {
                    if (!lastCompletedAgents.includes(agent)) {
                        const agentInfo = data.agent_config ? data.agent_config[agent] : null;
                        const agentName = agentInfo ? agentInfo.name : agent;
                        addLogEntry(`✅ ${agentName} completed successfully`, 'success');
                        lastCompletedAgents.push(agent);
                    }
                });
                
            } else {
                // Processing complete
                clearInterval(checkInterval);
                
                if (data.results) {
                    updateProgressDisplay(100, 'Complete!', 0);
                    addLogEntry('🎉 Travel plan created successfully!', 'success');
                    
                    // Mark all agents as complete
                    const allAgentItems = document.querySelectorAll('.agent-item');
                    allAgentItems.forEach(item => {
                        item.classList.remove('active');
                        item.classList.add('completed');
                    });
                    
                    const allActiveIcons = document.querySelectorAll('.active-icon');
                    allActiveIcons.forEach(icon => {
                        icon.classList.add('d-none');
                    });
                    
                    const allCompleteIcons = document.querySelectorAll('.complete-icon');
                    allCompleteIcons.forEach(icon => {
                        icon.classList.remove('d-none');
                    });
                    
                    // Redirect to results after a short delay
                    setTimeout(() => {
                        window.location.href = '/results';
                    }, 2000);
                } else {
                    updateProgressDisplay(100, 'Error occurred', 0);
                    addLogEntry('❌ Error: ' + (data.progress || 'Unknown error'), 'error');
                }
            }
        })
        .catch(error => {
            console.error('Status check failed:', error);
            addLogEntry('⚠️ Status check failed: ' + error.message, 'error');
        });
}

// Start checking status every 2 seconds
document.addEventListener('DOMContentLoaded', function() {
    addLogEntry('Processing started');
    checkInterval = setInterval(checkStatus, 2000);
    checkStatus(); // Check immediately
});

// Add pulse animation
const style = document.createElement('style');
style.textContent = `
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }
`;
document.head.appendChild(style);
</script>
{% endblock %} 

{% block extra_css %}
<style>
/* Enhanced Progress Tracking Styles */
.progress-container {
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

.progress {
    background-color: #f0f0f0;
    border-radius: 15px;
    overflow: hidden;
}

.progress-bar {
    background: linear-gradient(45deg, #007bff, #0056b3);
    transition: width 0.5s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
}

/* Enhanced Agent Status Styles */
.agent-status-list {
    max-width: 400px;
    margin: 0 auto;
}

.agent-status {
    max-width: 400px;
    margin: 0 auto;
}

.agent-item {
    padding: 12px 15px;
    margin: 8px 0;
    border-radius: 8px;
    background: #f8f9fa;
    transition: all 0.3s ease;
    border-left: 4px solid transparent;
}

.agent-item.active {
    background: #e3f2fd;
    border-left-color: #2196f3;
    box-shadow: 0 2px 8px rgba(33, 150, 243, 0.2);
    transform: translateX(2px);
}

.agent-item.completed {
    background: #e8f5e8;
    border-left-color: #4caf50;
    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.2);
}

.agent-icon {
    width: 20px;
    color: #666;
    transition: color 0.3s ease;
}

.agent-item.active .agent-icon {
    color: #2196f3;
}

.agent-item.completed .agent-icon {
    color: #4caf50;
}

.agent-name {
    font-weight: 500;
    color: #333;
}

.agent-item.active .agent-name {
    color: #1976d2;
    font-weight: 600;
}

.agent-item.completed .agent-name {
    color: #388e3c;
}

.agent-description {
    margin-top: 4px;
    margin-left: 32px;
    font-size: 0.85rem;
    line-height: 1.3;
}

.agent-status-icons {
    min-width: 20px;
}

.status-icon {
    font-size: 16px;
}

/* Animation for active agents */
.agent-item.active {
    animation: pulse-agent 2s infinite;
}

@keyframes pulse-agent {
    0% { transform: translateX(2px); }
    50% { transform: translateX(4px); }
    100% { transform: translateX(2px); }
}

/* Time remaining styling */
#time-remaining {
    font-weight: 600;
    color: #007bff;
}

/* Processing log enhancements */
#processingLog {
    font-family: 'Courier New', monospace;
    font-size: 0.9rem;
    line-height: 1.4;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .agent-item {
        padding: 10px 12px;
    }
    
    .agent-description {
        margin-left: 28px;
        font-size: 0.8rem;
    }
    
    .progress-container {
        padding: 15px;
    }
}

/* ========================================
   ADDITIONAL MOBILE OPTIMIZATIONS
======================================== */

/* Mobile-specific processing page optimizations */
@media (max-width: 768px) {
    /* Progress Section Mobile */
    .progress-container .progress {
        height: 25px;
        margin-bottom: 1rem;
    }
    
    #progress-text {
        font-size: 0.8rem;
        font-weight: 600;
    }
    
    /* Agent Items Mobile Enhancement */
    .agent-item {
        padding: 10px 12px;
        margin: 6px 0;
        border-radius: 6px;
        min-height: 44px; /* Touch target size */
        display: flex;
        align-items: center;
    }
    
    .agent-item.active {
        transform: none;
        box-shadow: 0 3px 12px rgba(33, 150, 243, 0.25);
        border-left-width: 3px;
    }
    
    .agent-item.completed {
        box-shadow: 0 2px 8px rgba(76, 175, 80, 0.2);
        border-left-width: 3px;
    }
    
    .agent-icon {
        font-size: 0.95rem;
        width: 18px;
        margin-right: 8px;
    }
    
    .agent-name {
        font-size: 0.9rem;
        margin-bottom: 2px;
    }
    
    .agent-description {
        font-size: 0.75rem;
        line-height: 1.3;
        margin-top: 2px;
        opacity: 0.8;
    }
    
    /* Status Text Mobile */
    #statusText {
        font-size: 1rem;
        margin-bottom: 0.5rem;
    }
    
    #statusDetail {
        font-size: 0.85rem;
        margin-bottom: 1rem;
    }
    
    /* Time Remaining Mobile */
    #time-remaining {
        font-size: 0.8rem;
    }
    
    /* Agent Section Headers Mobile */
    .card-header h6 {
        font-size: 0.95rem;
        margin-bottom: 0;
    }
    
    /* Validation Features Mobile */
    .validation-features {
        margin-top: 0.75rem;
    }
    
    .validation-features h6 {
        font-size: 0.85rem;
        margin-bottom: 0.5rem;
        color: #495057;
    }
    
    .validation-features ul {
        font-size: 0.8rem;
        padding-left: 1.2rem;
        margin-bottom: 0;
    }
    
    .validation-features li {
        margin-bottom: 0.25rem;
        line-height: 1.4;
    }
}

/* Small Mobile Specific */
@media (max-width: 576px) {
    .progress-container {
        padding: 10px;
    }
    
    .progress-container .progress {
        height: 20px;
    }
    
    #progress-text {
        font-size: 0.75rem;
    }
    
    .agent-item {
        padding: 8px 10px;
        margin: 4px 0;
        min-height: 40px;
    }
    
    .agent-name {
        font-size: 0.85rem;
    }
    
    .agent-description {
        font-size: 0.7rem;
    }
    
    .agent-icon {
        font-size: 0.9rem;
        width: 16px;
    }
    
    #statusText {
        font-size: 0.95rem;
    }
    
    #statusDetail {
        font-size: 0.8rem;
    }
    
    .card-header h2 {
        font-size: 1.3rem;
    }
    
    .card-header p {
        font-size: 0.85rem;
    }
}

/* Touch Device Optimizations */
@media (hover: none) and (pointer: coarse) {
    .agent-item {
        min-height: 48px; /* Larger touch targets */
        cursor: default;
    }
    
    .agent-item:hover {
        transform: none;
    }
    
    .agent-item:active {
        background: #e9ecef;
    }
    
    .agent-item.active:active {
        background: #d1ecf1;
    }
    
    .agent-item.completed:active {
        background: #d4edda;
    }
}

/* Landscape Mobile Optimization */
@media (max-height: 500px) and (orientation: landscape) {
    .card-header h2 {
        font-size: 1.2rem;
        margin-bottom: 0.25rem;
    }
    
    .card-header p {
        font-size: 0.8rem;
        margin-bottom: 0;
    }
    
    .progress-container {
        padding: 8px;
    }
    
    .agent-item {
        padding: 6px 8px;
        margin: 2px 0;
        min-height: 36px;
    }
    
    .agent-description {
        display: none; /* Hide descriptions in landscape to save space */
    }
    
    .validation-features {
        margin-top: 0.5rem;
    }
    
    .validation-features li {
        margin-bottom: 0.1rem;
    }
}
</style>
{% endblock %} 